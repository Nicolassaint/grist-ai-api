[pytest]
# Configuration pour Pytest

# Ajouter le répertoire racine au PYTHONPATH
pythonpath = .

# Répertoires de tests
testpaths = tests

# Pattern de découverte des tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Options d'affichage
addopts =
    # Affichage par fichier avec résultats (. pour pass, F pour fail)
    -v
    # Résumé court des échecs
    --tb=line
    # Strict markers
    --strict-markers
    # Masquer tous les warnings
    --disable-warnings
    
    # Couverture de code (décommenter si besoin)
    # --cov=app
    # --cov-report=term-missing
    # --cov-report=html:htmlcov
    
    # Options avancées (décommenter si besoin)
    # -v  # Mode verbeux
    # -s  # Afficher les print statements
    # --tb=short  # Traceback plus détaillé
    # -n auto  # Parallélisation (nécessite pytest-xdist)

# Markers personnalisés
markers =
    unit: Tests unitaires (fast, isolated)
    integration: Tests d'intégration (slower, requires services)
    slow: Tests lents (peut être skippé en développement)
    asyncio: Tests asynchrones
    architecture: Tests de l'agent d'architecture
    sql: Tests de l'agent SQL
    analysis: Tests de l'agent d'analyse
    router: Tests du router
    grist: Tests nécessitant l'API Grist
    llm: Tests nécessitant l'API OpenAI

# Timeout par défaut pour les tests async (en secondes)
asyncio_mode = auto

# Ignorer certains warnings (si --disable-warnings n'est pas utilisé)
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning

# Configuration de logging pour les tests (désactivée par défaut)
# Décommenter si vous voulez voir les logs
# log_cli = true
# log_cli_level = INFO
# log_cli_format = %(asctime)s [%(levelname)8s] %(message)s
# log_cli_date_format = %Y-%m-%d %H:%M:%S

# Fichier de logs pour les tests (décommenter si besoin)
# log_file = tests/logs/pytest.log
# log_file_level = DEBUG
# log_file_format = %(asctime)s [%(levelname)8s] %(name)s - %(message)s
# log_file_date_format = %Y-%m-%d %H:%M:%S
